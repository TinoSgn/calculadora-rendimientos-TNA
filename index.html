<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <title>Calculadora Rendimientos Pro</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="style.css" />
    <script
      src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"
      defer
    ></script>
    <script src="script.js" defer></script>
  </head>
  <body>
    <main class="container">
      <header class="fade-in-up">
        <h1>Proyección Financiera</h1>
        <p class="muted">
          Interés compuesto y simulaciones de ahorro inteligentes
        </p>
      </header>

      <section class="card fade-in-up" style="animation-delay: 0.1s">
        <div class="mode-selector">
          <button id="btnModeSimple" class="btn-mode active">
            Calculadora Rápida
          </button>
          <button id="btnModeSimulacion" class="btn-mode">
            Simulación Avanzada
          </button>
        </div>
      </section>

      <div id="modoSimple">
        <section class="card fade-in-up" style="animation-delay: 0.2s">
          <h2>Parámetros de Inversión</h2>
          <div class="grid">
            <label class="field">
              <span>Monto a invertir ($)</span>
              <input
                id="monto"
                type="text"
                inputmode="decimal"
                value="100.000"
                autocomplete="off"
              />
            </label>

            <label class="field">
              <span>TNA manual (%)</span>
              <input id="tnaManual" type="text" value="36" autocomplete="off" />
            </label>
          </div>

          <div class="row" style="margin-top: 24px">
            <div class="row gap">
              <button id="btnExport" class="btn">Descargar CSV</button>
              <button id="btnReset" class="btn" style="color: #ff6b6b">
                Reset
              </button>
            </div>
          </div>
        </section>

        <section class="card fade-in-up" style="animation-delay: 0.3s">
          <h2>Resultados Estimados</h2>
          <div class="results">
            <div class="result">
              <div class="label">TNA usada</div>
              <div class="value"><span id="tnaUsada">0</span>%</div>
              <div class="sub">Nominal Anual</div>
            </div>
            <div class="result">
              <div class="label">TEA Real</div>
              <div class="value"><span id="tea">0</span>%</div>
              <div class="sub">Efectiva Anual</div>
            </div>
            <div class="result">
              <div class="label">Tasa Diaria</div>
              <div class="value"><span id="tasaDiaria">0</span>%</div>
              <div class="sub">Interés por día</div>
            </div>
            <div class="result">
              <div class="label">Ganancia Diaria</div>
              <div class="value"><span id="gananciaDiaria">0</span></div>
            </div>
            <div class="result">
              <div class="label">Ganancia Mensual</div>
              <div class="value"><span id="gananciaMensual">0</span></div>
              <div class="sub">Reinversión diaria</div>
            </div>
            <div class="result">
              <div class="label">Ganancia Anual</div>
              <div class="value"><span id="gananciaAnual">0</span></div>
            </div>
          </div>
        </section>

        <section class="card fade-in-up" style="animation-delay: 0.4s">
          <div class="card-header-flex">
            <h2>Gráfico de Proyección</h2>
            <div class="toggle">
              <label>
                <input
                  type="radio"
                  name="granularidad"
                  value="mensual"
                  checked
                />
                <span>Mensual</span>
              </label>
              <label>
                <input type="radio" name="granularidad" value="diaria" />
                <span>Diario</span>
              </label>
            </div>
          </div>
          <div style="position: relative; height: 300px; width: 100%">
            <canvas id="chart"></canvas>
          </div>
        </section>

        <section class="card fade-in-up" style="animation-delay: 0.5s">
          <div class="card-header-flex">
            <h2>Tabla Detallada</h2>
            <div class="toggle" style="margin-bottom: 0">
              <label>
                <input type="radio" name="tablaGran" value="mensual" checked />
                <span>12 Meses</span>
              </label>
              <label>
                <input type="radio" name="tablaGran" value="diaria" />
                <span>30 Días</span>
              </label>
            </div>
          </div>

          <div id="tablaContMensual">
            <div class="table-wrap">
              <table id="tablaMensual">
                <thead>
                  <tr>
                    <th>Mes</th>
                    <th>Saldo inicial</th>
                    <th>Interés generado</th>
                    <th>Saldo final</th>
                  </tr>
                </thead>
                <tbody id="tablaBodyMensual"></tbody>
              </table>
            </div>
          </div>

          <div id="tablaContDiaria" style="display: none">
            <div class="table-wrap">
              <table id="tablaDiaria">
                <thead>
                  <tr>
                    <th>Día</th>
                    <th>Saldo inicial</th>
                    <th>Interés del día</th>
                    <th>Saldo final</th>
                  </tr>
                </thead>
                <tbody id="tablaBodyDiaria"></tbody>
              </table>
            </div>
          </div>
        </section>
      </div>

      <div id="modoSimulacion" style="display: none">
        <section class="card fade-in-up">
          <h2>Configurar Simulación</h2>
          <div class="grid">
            <label class="field">
              <span>Dinero Actual ($)</span>
              <input
                id="simDineroInicial"
                type="text"
                inputmode="decimal"
                value="0"
                autocomplete="off"
              />
            </label>

            <label class="field">
              <span>Sueldo Mensual ($)</span>
              <input
                id="simSueldo"
                type="text"
                inputmode="decimal"
                value="500.000"
                autocomplete="off"
              />
            </label>

            <label class="field">
              <span>Gastos Mensuales ($)</span>
              <input
                id="simGastos"
                type="text"
                inputmode="decimal"
                value="300.000"
                autocomplete="off"
              />
            </label>

            <label class="field">
              <span>TNA Estimada (%)</span>
              <input id="simTNA" type="text" value="36" autocomplete="off" />
            </label>

            <label class="field">
              <span>Vacaciones (Enero) ($)</span>
              <input
                id="simGastoVacaciones"
                type="text"
                inputmode="decimal"
                value="800.000"
                autocomplete="off"
              />
            </label>
          </div>

          <div class="checkbox-field">
            <label class="checkbox-label">
              <input type="checkbox" id="simIncluirAguinaldo" checked />
              <span>Incluir aguinaldos automáticos (Junio y Diciembre)</span>
            </label>
          </div>

          <div class="grid">
            <label class="field">
              <span>Duración (meses)</span>
              <input id="simMeses" type="number" min="1" max="60" value="12" />
            </label>

            <label class="field">
              <span>Mes de inicio</span>
              <input id="simMesInicio" type="month" />
              <small>Opcional (por defecto mes siguiente)</small>
            </label>
          </div>

          <div class="row" style="margin-top: 24px">
            <button id="btnSimular" class="btn btn-primary">
              Simular Ahorros
            </button>
            <button id="btnExportSimulacion" class="btn">Exportar CSV</button>
            <button id="btnResetSimulacion" class="btn" style="color: #ff6b6b">
              Reset
            </button>
          </div>
        </section>

        <section class="card" id="simResultados" style="display: none">
          <h2>Resultados de la Simulación</h2>
          <div class="results">
            <div class="result">
              <div class="label">Saldo Inicial</div>
              <div class="value"><span id="simSaldoInicial">0</span></div>
            </div>
            <div class="result" style="border-color: var(--accent)">
              <div class="label">Saldo Final</div>
              <div class="value" style="font-size: 2.2rem">
                <span id="simSaldoFinal">0</span>
              </div>
              <div class="sub">
                Al finalizar los <span id="simMesesTotal">0</span> meses
              </div>
            </div>
            <div class="result">
              <div class="label">Total Intereses</div>
              <div class="value"><span id="simTotalIntereses">0</span></div>
              <div class="sub">Ganancia pasiva</div>
            </div>
            <div class="result">
              <div class="label">Ahorro Neto</div>
              <div class="value"><span id="simTotalAhorro">0</span></div>
              <div class="sub">Sueldo - Gastos</div>
            </div>
            <div class="result">
              <div class="label">Aguinaldos</div>
              <div class="value"><span id="simAguinaldos">0</span></div>
            </div>
            <div class="result">
              <div class="label">Costo Vacaciones</div>
              <div class="value" style="color: #ff6b6b">
                <span id="simVacaciones" style="color: #ff6b6b">0</span>
              </div>
            </div>
          </div>
        </section>

        <section class="card" id="simGrafico" style="display: none">
          <h2>Evolución Patrimonial</h2>
          <div style="position: relative; height: 300px; width: 100%">
            <canvas id="chartSimulacion"></canvas>
          </div>
        </section>

        <section class="card" id="simTabla" style="display: none">
          <h2>Flujo de Fondos</h2>
          <div class="table-wrap">
            <table id="tablaSimulacion">
              <thead>
                <tr>
                  <th>Mes</th>
                  <th>Fecha</th>
                  <th>Inicial</th>
                  <th>Ingresos</th>
                  <th>Gastos</th>
                  <th>Intereses</th>
                  <th>Final</th>
                  <th>Eventos</th>
                </tr>
              </thead>
              <tbody id="tablaBodySimulacion"></tbody>
            </table>
          </div>
        </section>
      </div>

      <footer>
        <p class="muted" style="opacity: 0.5; font-size: 0.8rem">
          Cálculo local. No se envían datos.
        </p>
      </footer>
    </main>
  </body>
</html>
